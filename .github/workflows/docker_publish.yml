name: Publish Docker image
on:
  push:
    tags:
      - v*.*.*
      - v*.*

jobs:
  build_with_tag:
    name: Build Docker image with tag
    runs-on: ubuntu-latest
    steps:
      - name: Check out the repo
        uses: actions/checkout@v2
      - name: Get commit tag
        id: get-commit-tag
        run: |
           export VERSION=${GITHUB_REF#refs/tags/}
           echo "::set-output name=VERSION_TAG::${VERSION:1}"
      - name: Get version
        run: echo "Version is ${{ steps.get-commit-tag.outputs.VERSION_TAG }}"